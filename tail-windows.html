<script type="text/x-red" data-template-name="tail-windows">
    <div class="form-row">
        <label for="node-input-filename"><i class="fa fa-file"></i> Filename</label>
        <input type="text" id="node-input-filename">
    </div>
    <div class="form-row">
        <label for="node-input-create"><i class="fa fa-bars"></i><span> Optional</span></label>
        <input type="checkbox" id="node-input-create" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-create" style="width: 70%;"><span>Create File if not exists</span></label>
    </div>
    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-fromBeginning" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-fromBeginning" style="width: 70%;"><span>From beginning</span></label>
    </div>
    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-flushAtEOF" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-flushAtEOF" style="width: 70%;"><span>Flush at EOF</span></label>
    </div>
    <div class="form-row">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-skipBlank" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-skipBlank" style="width: 70%;"><span>Skip blank lines</span></label>
    </div>
    <div class="form-row" id="node-tail-windows-trim">
        <label>&nbsp;</label>
        <input type="checkbox" id="node-input-useTrim" style="display: inline-block; width: auto; vertical-align: top;">
        <label for="node-input-useTrim" style="width: 70%;"><span>Use .trim() to check for blank lines</span></label>
    </div>
    <div class="form-row">
        <label for="node-input-interval"><i class="fa fa-refresh"></i> Interval</label>
        <input type="text" id="node-input-interval" placeholder="250" style="width: 65px;">
        &nbsp;<span>milliseconds</span>
    </div>
    <div class="form-row">
        <label for="node-input-separator"><i class="fa fa-code"></i> Separator</label>
        <input type="text" id="node-input-separator" placeholder="[\r]{0,1}\n" style="width: 150px;">
    </div>
    <div class="form-row">
        <label for="node-input-encoding"><i class="fa fa-font"></i> Encoding</label>
        <select id="node-input-encoding" style="width: 150px;">
            <option value="utf-8">utf8&nbsp;/&nbsp;utf-8</option>
            <option value="ucs2">ucs2&nbsp;/&nbsp;ucs-2</option>
            <option value="utf16le">utf16le&nbsp;/&nbsp;utf-16le</option>
            <option value="latin1">latin1</option>
            <option value="binary">binary</option>
            <option value="base64">base64</option>
            <option value="ascii">ascii</option>
            <option value="hex">hex</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="tail-windows">
    <p>Tails (watches for things to be added) to the configured file. (Windows ONLY)</p>
    <p>Based on original Tail and <a href="https://github.com/lucagrulla/node-tail" target="_blank">lucagrulla/node-tail</a></p>
</script>

<script type="text/javascript">
    RED.nodes.registerType('tail-windows',{
        category: 'storage-input',
        defaults: {
            filename: {value: "", required: true},
            create: {value: false},
            fromBeginning: {value: false},
            flushAtEOF: {value: false},
            skipBlank: {value: false},
            useTrim: {value: false},
            interval: {value: ""},
            separator: {value: ""},
            encoding: {value: "utf-8"},
            name: {value: ""}
        },
        color: "burlywood",
        inputs: 0,
        outputs: 1,
        icon: "file.png",
        label: function() {
            return this.name||this.filename||"tail windows";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        oneditprepare: function() {
            $("#node-input-skipBlank").on("change",function() {
                if (this.checked === true) {
                    $("#node-tail-windows-trim").show();
                }
                else {
                    $("#node-tail-windows-trim").hide();
                }
            });
        }
    });
</script>
